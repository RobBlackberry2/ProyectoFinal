<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GDU-012 - Historial de Actividades</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="container">

    <header>
      <div class="brand">
        <div class="logo">NHS</div>
        <div>
          <h1>Historial de actividades</h1>
          <p>Auditoría del sistema</p>
        </div>
      </div>
    </header>

    <main>

      <section class="form-section">
        <h2>Ver historial de usuarios</h2>

        <label>filtrar por usuario</label>
        <select id="filtroUsuario">
          <option value="todos">todos</option>
          <option value="nicolas">nicolas</option>
          <option value="fiorella">fiorella</option>
          <option value="sofia">sofia</option>
        </select>

        <label>rango de fechas</label>
        <input type="date" id="fechaInicio">
        <input type="date" id="fechaFin">

        <button id="btnFiltrar" class="btn-primary">aplicar filtros</button>

        <div id="msg" class="msg" style="display:none;"></div>

        <h3>actividades registradas</h3>

        <table class="tabla">
          <thead>
            <tr>
              <th>fecha</th>
              <th>hora</th>
              <th>usuario</th>
              <th>acción</th>
            </tr>
          </thead>
          <tbody id="tablaHistorial">
          </tbody>
        </table>

      </section>

    </main>

  </div>

  <script>
    const historial = [
      { fecha: "2025-03-01", hora: "10:15", usuario: "nicolas", accion: "inició sesión" },
      { fecha: "2025-03-01", hora: "10:20", usuario: "fiorella", accion: "actualizó su perfil" },
      { fecha: "2025-03-02", hora: "09:50", usuario: "sofia", accion: "cambió contraseña" },
      { fecha: "2025-03-03", hora: "14:10", usuario: "nicolas", accion: "cerró sesión" }
    ];

    const tabla = document.getElementById('tablaHistorial');
    const msg = document.getElementById('msg');

    function cargarTabla(data) {
      tabla.innerHTML = "";
      data.forEach(reg => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${reg.fecha}</td>
          <td>${reg.hora}</td>
          <td>${reg.usuario}</td>
          <td>${reg.accion}</td>
        `;
        tabla.appendChild(tr);
      });
    }

    function mostrar(tipo, texto) {
      msg.className = "msg " + (tipo === "ok" ? "ok" : "err");
      msg.textContent = texto;
      msg.style.display = "block";
    }

    cargarTabla(historial);

    document.getElementById('btnFiltrar').addEventListener('click', () => {
      const usuario = document.getElementById('filtroUsuario').value;
      const inicio = document.getElementById('fechaInicio').value;
      const fin = document.getElementById('fechaFin').value;

      let filtrado = historial;

      if (usuario !== "todos") {
        filtrado = filtrado.filter(reg => reg.usuario === usuario);
      }

      if (inicio) {
        filtrado = filtrado.filter(reg => reg.fecha >= inicio);
      }
      if (fin) {
        filtrado = filtrado.filter(reg => reg.fecha <= fin);
      }

      if (filtrado.length === 0) {
        mostrar("err", "no hay resultados con esos filtros.");
      } else {
        msg.style.display = "none";
      }

      cargarTabla(filtrado);
    });
  </script>

</body>

</html>
